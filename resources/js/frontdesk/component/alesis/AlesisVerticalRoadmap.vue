<template>
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="662.442" height="536.549" viewBox="0 0 662.442 1076.549">
        <defs>
            <linearGradient id="vertical-linear-gradient" y1="0.5" x2="1" y2="0.5" gradientUnits="objectBoundingBox">
                <stop offset="0" stop-color="#45e3ff"/>
                <stop offset="1" stop-color="#9babff"/>
            </linearGradient>
            <linearGradient id="vertical-linear-gradient-2" x1="0.5" y1="-0.002" x2="0.5" y2="1" gradientUnits="objectBoundingBox">
                <stop offset="0" stop-color="#009dff"/>
                <stop offset="1" stop-color="#3656ff"/>
            </linearGradient>
            <linearGradient id="vertical-linear-gradient-3" x1="0.851" y1="0.149" x2="0.269" y2="0.732" gradientUnits="objectBoundingBox">
                <stop offset="0" stop-color="#e2e1e6"/>
                <stop offset="1" stop-color="#fff"/>
            </linearGradient>
            <linearGradient id="vertical-linear-gradient-4" x1="-10.329" y1="-27.483" x2="-10.329" y2="-28.472" xlink:href="#vertical-linear-gradient-2"/>
            <linearGradient id="vertical-linear-gradient-6" x1="15.659" y1="-38.718" x2="15.659" y2="-39.718" xlink:href="#vertical-linear-gradient-2"/>
            <linearGradient id="vertical-linear-gradient-8" x1="-10.494" y1="-40.022" x2="-10.494" y2="-41.023" xlink:href="#vertical-linear-gradient-2"/>
        </defs>
        <g id="bg-2" transform="translate(-0.67 -0.09)">
            <image class="導覽箭頭" @click="next" transform="rotate(270, 50, 1050) translate(50.067 1050.043)" height="60" width="60" href="/images/alesis-carousel-left.svg"></image>
            <image class="導覽箭頭" @click="prev" transform="rotate(270, 580, 90) translate(580.067 90.043)" height="60" width="60" href="/images/alesis-carousel-right.svg"></image>


            <g id="Group_3583" data-name="Group 3583" transform="translate(1.17 0.59)">
                <g id="Group_3582" data-name="Group 3582" transform="translate(0)">
                    <g id="Group_3577" data-name="Group 3577">
                        <path id="Path_4432" data-name="Path 4432" d="M526.646,918.435a833.935,833.935,0,0,1-92.512-28.266c-27.31-9.854-55.962-21.324-90.35-36.14C326.511,846.474,312.4,840.124,299.406,834c-4.825-2.276-9.649-4.438-14.451-6.6l-7.851-3.55-22.121-10.309c-31.861-15.111-59.99-29.79-86.185-44.879-24.806-14.542-53.6-32.407-79.153-54.733a233.471,233.471,0,0,1-17.023-16.636c-2.094-2.276-3.983-4.552-5.985-6.827l-1.525-1.8-1.3-1.753c-1.934-2.594-3.778-5.052-5.394-7.738a70.071,70.071,0,0,1-9.24-20.118,41.24,41.24,0,0,1-.523-20.778,46.781,46.781,0,0,1,9.74-18.775A84.912,84.912,0,0,1,75.125,604.35a185.417,185.417,0,0,1,41.989-21.256,324.536,324.536,0,0,1,45.994-13.245l2.913-.592c.819-.137,1.525-.319,2.276-.5l6.987-1.707c4.028-.979,8.034-1.98,11.948-3.027,7.965-2,15.931-4.21,23.782-6.327a824.191,824.191,0,0,0,93.308-31.588,446.539,446.539,0,0,0,44.7-21.393,263.112,263.112,0,0,0,41.443-27.9c14.679-12.426,25.375-25.034,32.7-38.689a90,90,0,0,0,8.853-24.351,85.648,85.648,0,0,0,1.183-25.967,118.319,118.319,0,0,0-17.046-47.792,227.849,227.849,0,0,0-30.45-39.554c-19.891-21.142-43.832-41.4-75.489-63.609-24.852-17.433-52.116-34.433-83.363-52-27.469-15.407-55.985-30.154-87.141-45.061-32.2-15.339-61.447-28.288-89.735-39.6l-2.572,6.4c27.97,11.379,57.077,24.556,89.03,40.054,30.473,14.838,59.512,30.132,86.344,45.516,30.86,17.638,57.783,34.683,82.271,52.116,30.906,22.144,54.3,42.125,73.577,62.812a219.114,219.114,0,0,1,28.9,38.052,108.078,108.078,0,0,1,15.339,43.65,74.691,74.691,0,0,1-1.183,22.758,79.7,79.7,0,0,1-7.965,21.393,123.97,123.97,0,0,1-30.382,35.321,249.7,249.7,0,0,1-39.827,26.377,435.544,435.544,0,0,1-43.7,20.482,800.955,800.955,0,0,1-92.216,30.4c-7.647,2.048-15.567,4.142-23.6,6.122-3.914,1-7.852,1.935-11.766,2.868l-6.964,1.661c-.569.137-1.138.273-1.684.364l-3.1.592a334.607,334.607,0,0,0-48.02,13.473,196.187,196.187,0,0,0-45.22,22.531,98.127,98.127,0,0,0-19.5,17.5,60.575,60.575,0,0,0-12.7,24.192,56.021,56.021,0,0,0,.387,27.674,85.156,85.156,0,0,0,10.787,24.169c1.889,3.163,4.051,6.1,6.122,8.921l2.89,3.687c2.117,2.64,4.324,5.348,6.645,7.806a239.7,239.7,0,0,0,17.956,17.774c26.445,23.509,55.871,41.966,81.2,57.077,26.513,15.5,54.961,30.587,87.027,46.108l22.189,10.537L278.1,842.2c4.779,2.276,9.558,4.392,14.247,6.645,13.154,6.3,27.31,12.836,44.7,20.482,34.592,15.2,63.541,27.037,91.032,37.209a855.432,855.432,0,0,0,94.355,29.586l3.368.8,4.119-17.751-3.277-.728Z" transform="translate(42.353 126.481)" opacity="0.2" fill="url(#vertical-linear-gradient)"/>
                        <circle id="Ellipse_82" data-name="Ellipse 82" cx="10.491" cy="10.491" r="10.491" transform="translate(78.834 219.343)" fill="url(#vertical-linear-gradient-2)"/>
                        <path id="Path_4433" data-name="Path 4433" d="M0,131.428H0a76.944,76.944,0,0,0,76.945,76.945h0a76.944,76.944,0,0,0,76.945-76.945h0A76.969,76.969,0,0,0,95.447,56.736a24.008,24.008,0,0,1-18.5-23.122V0" transform="translate(166.271 208.373) rotate(180)" fill="none" stroke="#76c3ff" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" fill-rule="evenodd"/>
                        <g id="Group_3573" data-name="Group 3573" transform="translate(28.152 15.589)">
                            <circle id="Ellipse_83" data-name="Ellipse 83" cx="61.174" cy="61.174" r="61.174" transform="translate(0 0)"/>
                            <circle id="Ellipse_84" data-name="Ellipse 84" cx="61.174" cy="61.174" r="61.174" transform="translate(0 0)" fill="url(#vertical-linear-gradient-3)"/>
                        </g>
                        <path id="Path_4434" v-if="sets[current_set_index].length >= 2" data-name="Path 4434" d="M228.1,234.075a13.154,13.154,0,1,1,0-.182v.182Z" transform="translate(257.059 280.394)" fill="url(#vertical-linear-gradient-4)"/>
                        <path id="Path_4435" v-if="sets[current_set_index].length >= 2" data-name="Path 4435" d="M171.81,199.767h0a81.477,81.477,0,0,1,81.474-81.5h0a81.5,81.5,0,0,1,81.5,81.5h0a81.574,81.574,0,0,1-61.9,79.137,25.376,25.376,0,0,0-19.595,24.465v35.6" transform="translate(218.81 149.547)" fill="none" stroke="#76c3ff" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" fill-rule="evenodd"/>
                        <g id="Group_3574" v-if="sets[current_set_index].length >= 2" data-name="Group 3574" transform="translate(406.369 283.407)">
                            <circle id="Ellipse_85" data-name="Ellipse 85" cx="65.725" cy="65.725" r="65.725"/>
                            <circle id="Ellipse_86" data-name="Ellipse 86" cx="65.725" cy="65.725" r="65.725" fill="url(#vertical-linear-gradient-3)"/>
                        </g>
                        <circle id="Ellipse_87" v-if="sets[current_set_index].length >= 3" data-name="Ellipse 87" cx="16.067" cy="16.067" r="16.067" transform="translate(69.981 761.805)" fill="url(#vertical-linear-gradient-6)"/>
                        <path id="Path_4436" v-if="sets[current_set_index].length >= 3" data-name="Path 4436" d="M0,146.972H0a86.046,86.046,0,0,0,86.1,86.046h0a86.046,86.046,0,0,0,86.044-86.046h0a86.124,86.124,0,0,0-65.43-83.552A26.824,26.824,0,0,1,86.1,37.565V0" transform="translate(172.142 750.219) rotate(180)" fill="none" stroke="#76c3ff" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" fill-rule="evenodd"/>
                        <g id="Group_3575" v-if="sets[current_set_index].length >= 3" data-name="Group 3575" transform="translate(15.771 532.79)">
                            <circle id="Ellipse_88" data-name="Ellipse 88" cx="70.277" cy="70.277" r="70.277"/>
                            <circle id="Ellipse_89" data-name="Ellipse 89" cx="70.277" cy="70.277" r="70.277" fill="url(#vertical-linear-gradient-3)"/>
                        </g>
                        <circle id="Ellipse_90" v-if="sets[current_set_index].length >= 4" data-name="Ellipse 90" cx="22.28" cy="22.28" r="22.28" transform="translate(552.271 1031.488)" fill="url(#vertical-linear-gradient-8)"/>
                        <path id="Path_4437" v-if="sets[current_set_index].length >= 4" data-name="Path 4437" d="M213.21,431.986h0a88.327,88.327,0,0,1,88.276-88.326h0a88.331,88.331,0,0,1,88.327,88.326h0a88.38,88.38,0,0,1-67.089,85.769A27.531,27.531,0,0,0,301.486,544.3v38.559" transform="translate(271.629 437.102)" fill="none" stroke="#76c3ff" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" fill-rule="evenodd"/>
                        <g id="Group_3576" v-if="sets[current_set_index].length >= 4" data-name="Group 3576" transform="translate(500.61 796.352)">
                            <circle id="Ellipse_91" data-name="Ellipse 91" cx="72.553" cy="72.553" r="72.553"/>
                            <circle id="Ellipse_92" data-name="Ellipse 92" cx="72.553" cy="72.553" r="72.553" fill="url(#vertical-linear-gradient-3)"/>
                        </g>
                    </g>
                    <g v-if="paths.length > 0">
                        <g id="Group_3578" data-name="Group 3578" transform="translate(188.505 35.07)">
                            <path id="Path_4438" data-name="Path 4438" d="M1,18H285.476" transform="translate(1.276 22.965)" fill="none" stroke="#76c3ff" stroke-width="1" fill-rule="evenodd"/>
                            <text id="_2017.12" data-name="2017.12" transform="translate(189.438 28)" fill="#157efb" font-size="24" font-family="SegoeUI-Light, Segoe UI" font-weight="300"><tspan x="0" y="0">{{ sets[current_set_index][0] !== undefined ? sets[current_set_index][0].hook_date : '' }}</tspan></text>
                            <text transform="translate(0 28)" fill="#157efb" font-size="24" font-family="YuGothicUI-Regular, Yu Gothic UI">{{ sets[current_set_index][0] !== undefined ? sets[current_set_index][0].title : '' }}</text>
                            <text transform="translate(1.138 69.516)" fill="#157efb" font-size="21" font-family="YuGothicUI-Regular, Yu Gothic UI" v-html="sets[current_set_index][0] !== undefined ? sets[current_set_index][0].content : ''"></text>
                            <image transform="matrix(1, 0, 0, 1, -160.3, -20.639)" height="120" width="120" :href="sets[current_set_index][0] !== undefined ? sets[current_set_index][0].icon : ''"></image>
                        </g>
                        <g id="Group_3579" v-if="sets[current_set_index].length >= 3" data-name="Group 3579" transform="translate(194.195 558.507)">
                            <path id="Path_4439" data-name="Path 4439" d="M1,20H285.476" transform="translate(0.138 25.516)" fill="none" stroke="#76c3ff" stroke-width="1" fill-rule="evenodd"/>
                            <text id="_2018.04" data-name="2018.04" transform="translate(188.301 32.552)" fill="#157efb" font-size="24" font-family="SegoeUI-Light, Segoe UI" font-weight="300">{{ sets[current_set_index][2] !== undefined ? sets[current_set_index][2].hook_date : '' }}</text>
                            <text transform="translate(1.138 31)" fill="#157efb" font-size="27" font-family="YuGothicUI-Regular, Yu Gothic UI">{{ sets[current_set_index][2] !== undefined ? sets[current_set_index][2].title : '' }}</text>
                            <text transform="translate(0 80.344)" fill="#157efb" font-size="24" font-family="YuGothicUI-Regular, Yu Gothic UI" v-html="sets[current_set_index][2] !== undefined ? sets[current_set_index][2].content : ''"></text>
                            <image transform="matrix(1, 0, 0, 1, -168.3, -19.639)" height="120" width="120" :href="sets[current_set_index][2] !== undefined ? sets[current_set_index][2].icon : ''"></image>
                        </g>
                        <g id="Group_3580" v-if="sets[current_set_index].length >= 2" data-name="Group 3580" transform="translate(81.542 303.616)">
                            <path id="Path_4440" data-name="Path 4440" d="M1,20H285.476" transform="translate(-1 25.516)" fill="none" stroke="#76c3ff" stroke-width="1" fill-rule="evenodd"/>
                            <text id="_2018.02" data-name="2018.02" transform="translate(285.72 31)" text-anchor="end" fill="#157efb" font-size="24" font-family="SegoeUI-Light, Segoe UI" font-weight="300">{{ sets[current_set_index][1] !== undefined ? sets[current_set_index][1].hook_date : '' }}</text>
                            <text transform="translate(4.72 31)" fill="#157efb" font-size="27" font-family="YuGothicUI-Regular, Yu Gothic UI">{{ sets[current_set_index][1] !== undefined ? sets[current_set_index][1].title : '' }}</text>
                            <text transform="translate(289.446 80.344)" text-anchor="end" fill="#157efb" font-size="24" font-family="YuGothicUI-Regular, Yu Gothic UI" v-html="sets[current_set_index][1] !== undefined ? sets[current_set_index][1].content : ''"></text>
                            <image transform="matrix(1, 0, 0, 1, 329.7, -20.639)" height="120" width="120" :href="sets[current_set_index][1] !== undefined ? sets[current_set_index][1].icon : ''"></image>
                        </g>
                        <g id="Group_3581" v-if="sets[current_set_index].length >= 4" data-name="Group 3581" transform="translate(131.61 813.397)">
                            <path id="Path_4441" data-name="Path 4441" d="M1,25H330.993" transform="translate(-1 31.895)" fill="none" stroke="#76c3ff" stroke-width="1" fill-rule="evenodd"/>
                            <text id="_2018.08" data-name="2018.08" transform="translate(0.546 37.103)" fill="#157efb" font-size="24" font-family="SegoeUI-Light, Segoe UI" font-weight="300">{{ sets[current_set_index][3] !== undefined ? sets[current_set_index][3].hook_date : '' }}</text>
                            <text transform="translate(330.72 38)" fill="#157efb" font-size="28" text-anchor="end" font-family="YuGothicUI-Regular, Yu Gothic UI">{{ sets[current_set_index][3] !== undefined ? sets[current_set_index][3].title : '' }}</text>
                            <g id="Group" transform="translate(7.965 65.999)">
                                <text transform="translate(319.467 31)" fill="#157efb" font-size="27" text-anchor="end" font-family="YuGothicUI-Regular, Yu Gothic UI" v-html="sets[current_set_index][3] !== undefined ? sets[current_set_index][3].content : ''"></text>
                                <image transform="matrix(1, 0, 0, 1, 373.7, -70.639)" height="120" width="120" :href="sets[current_set_index][3] !== undefined ? sets[current_set_index][3].icon : ''"></image>
                            </g>
                        </g>
                    </g>
                </g>
            </g>
        </g>
    </svg>
</template>

<style scoped lang="scss">
    svg {
        touch-action: manipulation;
    }
</style>

<script>
import {alesisCompanyIntroductions} from './../../pages/api'

export default {
    name: "VerticalPath",
    mounted() {
        alesisCompanyIntroductions().then(v => {
            this.paths = JSON.parse(JSON.stringify(v));
            this.initRoadmap();
        })
    },
    data() {
        return {
            paths            : {},
            sets             : [[]],
            current_set_index: 0,
        }
    },
    methods: {
        // initRoadmap 會將接收到的資料以每四個為一組的方式切分。
        initRoadmap() {
            this.paths = this.paths.map(v => {
                // 以換行符號進行換行。
                //v.content = `<tspan x="0" dy="0">${v.content.split("\n").join(`</tspan><tspan x="0" dy="1.2em">`)}</tspan>`

                // 自動字數換行。
                v.content = `<tspan x="0" dy="0">${v.content.match(/.{1,15}/g).join(`</tspan><tspan x="0" dy="1.2em">`)}</tspan>`
                return v
            })

            this.paths = this.paths.sort((a, b) => {
                return new Date(a.hook_date) - new Date(b.hook_date)
            });

            this.paths.forEach((v) => {
                if (this.sets[this.sets.length-1].length === 4) {
                    this.sets.push([]);
                }
                this.sets[this.sets.length-1].push(v);
          })
        },

        // next 會往下一組檢視。
        next() {
            if(this.current_set_index + 1 > this.sets.length-1) {
                this.current_set_index = 0;
            } else {
                this.current_set_index++;
            }

        },

        // prev 會往上一組檢視。
        prev() {
            if(this.current_set_index - 1 < 0) {
                this.current_set_index = this.sets.length-1;
            } else {
                this.current_set_index--;
            }
        },
    }
}
</script>
